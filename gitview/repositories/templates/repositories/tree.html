{% extends "repositories/files_base.html" %}

{% block css %}
{{ block.super }}
<style type="text/css">
.tree-icon {
    width: 16px;
}

.tree-time {
    text-align: right;
}
</style>
{% endblock %}

{% block repository-contents %}
{% block navigation-row %}
{{ block.super }}
{% endblock %}

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-info">
            {% block commit %}{% block commit-data %}
            {{ block.super }}
            {% endblock %}{% endblock %}
            
            <table class="table">
                {% if current_tree.path %}
                <tr>
                    <td class="tree-icon">
                    </td>
                    <td>
                        <a title="Go to tree root"
                           href="{% url "repos:tree_index" repository.owner.username repository.name current_tree_name %}">
                            ..
                        </a>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                {% endif %}
                {% for tree, tree_commit in trees %}
                <tr>
                    <td class="tree-icon">
                        <i class="icon-folder-close"></i>
                    </td>
                    <td>
                        <a title="{{ tree.name }}"
                           href="{% url "repos:tree_path" repository.owner.username repository.name current_tree_name tree.path %}">
                            {{ tree.name }}
                        </a>
                    </td>
                    <td>
                        <a href="{% url "repos:commit" repository.owner.username repository.name tree_commit.hexsha %}"
                           title="{{ tree_commit.summary }}">
                            {{ tree_commit.summary }}
                        </a>
                    </td>
                    <td class="tree-time">
                        <time class="js-relative-time"
                              datetime="{{ tree_commit.committed_time | date:"c" }}">
                            {{ tree_commit.committed_time }}
                        </time>
                    </td>
                </tr>
                {% endfor %}
                {% for blob, blob_commit in blobs %}
                <tr>
                    <td class="tree-icon">
                        <i class="icon-file-alt"></i>
                    </td>
                    <td>
                        <a href="{% url "repos:blob" repository.owner.username repository.name current_tree_name blob.path %}"
                           title="{{ blob.name }}">
                            {{ blob.name }}
                        </a>
                    </td>
                    <td>
                        <a href="{% url "repos:commit" repository.owner.username repository.name blob_commit.hexsha %}"
                           title="{{ blob_commit.summary }}">
                            {{ blob_commit.summary }}
                        </a>
                    </td>
                    <td class="tree-time">
                        <time class="js-relative-time"
                              datetime="{{ blob_commit.committed_time | date:"c" }}">
                            {{ blob_commit.committed_time }}
                        </time>
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>
{% endblock %}
